#!/usr/bin/perl

# <!--

use strict;
use warnings;

use CGI;

use Data::Dumper;

use domain::Post;
use types::Result;
use repository::PostRepository;

use view::placeholder;

local $Data::Dumper::Terse = 1;

###########################################################3

&placeholder::apply("post", sub {
  my $id = $_[0]->param("id");
  my %post = &PostRepository::get_by_id($id);

  if(!Result::is_ok(\%post)) {
    return "Could not find the post";
  }
  my %raw_post = Result::unwrap(\%post);

  my $author = Post::author(\%raw_post);
  my $content = Post::content(\%raw_post);

  return <<EOF
<!-- -->
  $author
  $content
<!--
EOF
;})

